<!-- Filter Info Header - Desktop Only -->
<div class="filter-header-desktop" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px 25px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);">
  <div style="display: flex; align-items: center; margin-bottom: 12px;">
    <mat-icon style="color: white; margin-right: 10px; font-size: 24px;">filter_alt</mat-icon>
    <h3 style="color: white; margin: 0; font-weight: 600; font-size: 18px;">Filter Riwayat</h3>
  </div>
  
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
    <!-- Periode Filter -->
    <div style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 12px 15px; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.2);">
      <div style="display: flex; align-items: center; margin-bottom: 5px;">
        <mat-icon style="color: rgba(255, 255, 255, 0.9); font-size: 18px; width: 18px; height: 18px; margin-right: 8px;">date_range</mat-icon>
        <span style="color: rgba(255, 255, 255, 0.9); font-size: 12px; font-weight: 500;">Periode</span>
      </div>
      <div style="color: white; font-size: 14px; font-weight: 600; margin-left: 26px;">
        {{ startDate | date:'dd MMM yyyy' }} - {{ endDate | date:'dd MMM yyyy' }}
      </div>
    </div>

    <!-- Vendor Filter -->
    <div style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 12px 15px; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.2);">
      <div style="display: flex; align-items: center; margin-bottom: 5px;">
        <mat-icon style="color: rgba(255, 255, 255, 0.9); font-size: 18px; width: 18px; height: 18px; margin-right: 8px;">store</mat-icon>
        <span style="color: rgba(255, 255, 255, 0.9); font-size: 12px; font-weight: 500;">Vendor</span>
      </div>
      <div style="color: white; font-size: 14px; font-weight: 600; margin-left: 26px;">
        {{ selectedVendorName || 'Semua Vendor' }}
      </div>
    </div>

    <!-- Keyword Filter -->
    <div style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 12px 15px; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.2);">
      <div style="display: flex; align-items: center; margin-bottom: 5px;">
        <mat-icon style="color: rgba(255, 255, 255, 0.9); font-size: 18px; width: 18px; height: 18px; margin-right: 8px;">search</mat-icon>
        <span style="color: rgba(255, 255, 255, 0.9); font-size: 12px; font-weight: 500;">Pencarian</span>
      </div>
      <div style="color: white; font-size: 14px; font-weight: 600; margin-left: 26px;">
        {{ filterRiwayat || 'Tidak ada filter' }}
      </div>
    </div>

    <!-- Total Results -->
    <div style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 12px 15px; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.2);">
      <div style="display: flex; align-items: center; margin-bottom: 5px;">
        <mat-icon style="color: rgba(255, 255, 255, 0.9); font-size: 18px; width: 18px; height: 18px; margin-right: 8px;">assignment</mat-icon>
        <span style="color: rgba(255, 255, 255, 0.9); font-size: 12px; font-weight: 500;">Total Unit</span>
      </div>
      <div style="color: white; font-size: 14px; font-weight: 600; margin-left: 26px;">
        {{ sampleData?.total_items || 0 }} Unit
      </div>
    </div>
  </div>
</div>

<style>
  /* Hide on mobile, show on desktop/laptop */
  @media (max-width: 768px) {
    .filter-header-desktop {
      display: none !important;
    }
  }
</style>

<div class="product-container" @productCardStagger>  
    <!-- Loading Overlay -->
    <div *ngIf="isLoading" style="display: flex; justify-content: center; align-items: center; min-height: 300px; width: 100%;">
      <div style="text-align: center;">
        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
          <span class="sr-only">Loading...</span>
        </div>
        <p style="margin-top: 15px; color: #666; font-weight: 500;">Memuat data...</p>
      </div>
    </div>

    <div class="product-card" *ngFor="let product of sampleData?.results"  @productCardAnimation (click)="GoesToDetailRiwayat(product.id)">  
      <div class="product-image" [ngStyle]="{'background-image': getThumbnailUrl(product.thumbnail_url) ? 'url(' + getThumbnailUrl(product.thumbnail_url) + ')' : '../../assets/icons/noimages.png'}">  
        <div *ngIf="!product.thumbnail_url" class="placeholder"></div>  
      </div>  
      <div class="product-details">  
        <!-- Product Header -->  
        <div class="product-header">  
            <div class='hy'>{{ product.display_name }}</div>  
            <div class="status-container" *ngIf="fromDashboard==false">  
              <span class="status-header">Last saved: {{ product.bastk_timestamp | date: 'dd MMMM yyyy, HH:mm' }} WIB</span>  
              <span class="status" [ngClass]="getStatusClass(product.bastk_status)">DONE</span>    
            </div>  
          </div>   
        <!-- Auction Location and Date --> 
        <div class="container">
          <div class="auction-info" class="row">
            <div class="col-sm-12 p-0 d-flex align-items-center" style="font-size:11px;font-weight:700;">
              <img src="../../assets/icons/location.svg" alt="Logo" style="height:16px;width:16px;margin-right:6px;">
              <span>
                {{ product.unit_location == null ? 'Tribik' : product.unit_location }} - 
                <!-- {{ product.mobilization_units[0].mobiliztion.assignment_date | date: 'dd MMMM yyyy' }} -->
                {{ product.mobilization_units && product.mobilization_units[0]?.mobilization?.assignment_date 
                  ? (product.mobilization_units[0].mobilization.assignment_date | date: 'dd MMMM yyyy') 
                  : (currentDate | date: 'dd MMMM yyyy') }}
              </span>
            </div>
          </div> 
        </div>
 
        <!-- Key-Value pairs for Kategori and Nopol -->  
        <div class="key-value">  
          <div class="key-value-item">  
            <span class="key">Kategori</span>  
            <span class="value">{{ product.unit_category.category_name }}</span>  
          </div>  
          <div class="key-value-item">  
            <span class="key">Nopol</span>  
            <span class="value">{{ product.police_number }}</span>  
          </div>  
          <div class="key-value-item">  
            <span class="key">Merek</span>  
            <span class="value">{{ product.brand.brand_name }}</span>  
          </div>  
          <div class="key-value-item">  
            <span class="key">Type</span>  
            <span class="value">{{ product.unit_type.type_name }}</span>  
          </div>  
        </div>  
        <!-- Key-Value pairs for Warna, Transmisi, etc. -->  
        <div class="key-value">  
          <div class="key-value-item">  
            <span class="key">Warna</span>  
            <span class="value">{{ product.color.color_name }}</span>  
          </div>  
          <div class="key-value-item">  
            <span class="key">Transmisi</span>  
            <span class="value">{{ product.transmission }}</span>  
          </div>  
          <div class="key-value-item">  
            <span class="key">CC</span>  
            <span class="value">{{ product.odo_meter }}</span>  
          </div>  
          <div class="key-value-item">  
            <span class="key">Tahun</span>  
            <span class="value">{{ product.unit_year }}</span>  
          </div>  
        </div>  
      </div>  
    </div>  
  </div>  
  