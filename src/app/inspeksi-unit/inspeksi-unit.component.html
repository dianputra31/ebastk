
<div class="grid-container">

  <ng-container *ngIf="!isLoading">
    <ng-container *ngIf="sortedGroupedSubItems.length > 0; else emptyState">
      <div *ngFor="let item of sortedGroupedSubItems" style="flex-direction: row;">
        <div class="grid-item {{item.item_category_chipclass}}" >
          <div class="text">
            <h3 class="labelinspeksi">{{ item.item_category_chiplabel }}. <br/>{{ item.item_category_chipname }}</h3>
            <ng-container *ngIf="item.item_category_chipclass==='notyet';else showbaten">
              <div class="status rungrampung">Complete previous task to start</div>
            </ng-container>
            <ng-template #showbaten>
              <div class="status">
                <button class="item-button {{item.item_category_buttonclass}}" 
                (click)="GoesToInspection(item.item_category_url)"
                >{{item.item_category_buttonlabel}}</button>
              </div>
            </ng-template>
          </div>
          <img [src]="item.item_category_icon" alt="Icon">
        </div>
      </div>
    </ng-container>

    <ng-template #emptyState>
      <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; padding: 60px 20px; text-align: center;">
        <img src="assets/icons/empty-box-icon.png" alt="Empty" style="width: 120px; height: 120px; margin-bottom: 20px; opacity: 0.6;">
        <p style="font-size: 18px; color: #141414; font-weight: 700;">Belum ada item BASTK di kategori ini</p>
        <p style="font-size: 18px; color: #666; font-weight: 500; font-size: 16px;">Harap hubungi admin terkait</p>
      </div>
    </ng-template>
  </ng-container>

</div>


<!-- Modal Pilihan -->
<div *ngIf="isChoiceModalOpen" class="choice-modal-overlay" (click)="closeChoiceModal()">
  <div class="choice-modal-content" (click)="$event.stopPropagation()">
    <div class="choice-modal-header">
      <h3>Pilih Tujuan</h3>
      <button class="close-btn" (click)="closeChoiceModal()">&times;</button>
    </div>
    
    <div class="choice-modal-body">
      <p class="instruction-text">Silakan pilih menu yang ingin Anda tuju:</p>
      
      <div class="choice-cards">
        <!-- Card Dokumen BASTK -->
        <div class="choice-card" 
             [class.disabled]="isDokumenBASTKDisabled()"
             (click)="!isDokumenBASTKDisabled() && goToDokumenBASTK()">
          <div class="card-icon">
            <img src="../../assets/icons/document-icon.svg" alt="Dokumen" 
                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
            <span class="fallback-icon" style="display:none;">ðŸ“„</span>
          </div>
          <h4>Dokumen BASTK</h4>
          <p>{{ isDokumenBASTKDisabled() ? 'Dokumen sudah ditandatangani' : 'Lihat ringkasan dan unduh dokumen BASTK' }}</p>
        </div>
        
        <!-- Card Unit Photos -->
        <div class="choice-card" (click)="goToUnitPhotos()">
          <div class="card-icon">
            <img src="../../assets/icons/camera-icon.svg" alt="Photos" 
                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
            <span class="fallback-icon" style="display:none;">ðŸ“¸</span>
          </div>
          <h4>Unit Photos</h4>
          <p>Upload dan kelola foto unit</p>
        </div>
      </div>
    </div>
  </div>
</div>


<div *ngIf="isLoading" class="loading-overlay">
  <div class="loading-spinner"></div>
  <div class="loading-text">Data sedang dimuat...</div>
</div>

